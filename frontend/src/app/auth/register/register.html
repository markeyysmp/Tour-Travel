<app-navbar class="fixed top-0 left-0 w-full z-50"></app-navbar>

<div class="min-h-screen flex items-center justify-center bg-gray-50 font-kanit pt-32">
	<div class="bg-white shadow-md rounded-xl w-full max-w-md border border-gray-200 transition-all duration-300 flex flex-col">

		<!-- ====== สมาชิก / บริษัท ====== -->
		<div class="flex">
			<button
				class="flex-1 py-3 text-center font-medium rounded-t-xl"
				[ngClass]="mode === 'member' ? 'bg-[#3500a8] text-white' : 'bg-white text-gray-700'"
				(click)="setMode('member')"
			>
				สมาชิก
			</button>
			<button
				class="flex-1 py-3 text-center font-medium rounded-t-xl"
				[ngClass]="mode === 'company' ? 'bg-[#3500a8] text-white' : 'bg-white text-gray-700'"
				(click)="setMode('company')"
			>
				บริษัท
			</button>
		</div>

		<hr class="border-gray-200" />

		<!-- ================== ฟอร์มสมาชิก ================== -->
		<div *ngIf="mode === 'member'" class="p-8 flex-1">
			<h2 class="text-center text-lg font-semibold mb-6">สมัครสมาชิก</h2>

			<form class="space-y-4" (ngSubmit)="$event.preventDefault()">

				<div class="grid grid-cols-2 gap-3">
					<div>
						<label class="block text-sm font-medium mb-1">
							ชื่อ <span class="text-red-500">*</span>
						</label>
						<input
							type="text"
							name="memberFirstname"
							[(ngModel)]="member.firstname"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
					<div>
						<label class="block text-sm font-medium mb-1">
							นามสกุล <span class="text-red-500">*</span>
						</label>
						<input
							type="text"
							name="memberLastname"
							[(ngModel)]="member.lastname"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
				</div>

				<div>
					<label class="block text-sm font-medium mb-1">
						อีเมล <span class="text-red-500">*</span>
					</label>
					<input
						type="email"
						name="memberEmail"
						[(ngModel)]="member.email"
						class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
					/>
				</div>

				<div>
					<label class="block text-sm font-medium mb-1">
						เบอร์โทร
					</label>
					<input
						type="tel"
						name="memberPhone"
						[(ngModel)]="member.phone"
						class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
					/>
				</div>

				<div class="grid grid-cols-2 gap-3">
					<div>
						<label class="block text-sm font-medium mb-1">
							รหัสผ่าน <span class="text-red-500">*</span>
						</label>
						<input
							type="password"
							name="memberPassword"
							[(ngModel)]="member.password"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
					<div>
						<label class="block text-sm font-medium mb-1">
							ยืนยันรหัสผ่าน <span class="text-red-500">*</span>
						</label>
						<input
							type="password"
							name="memberPasswordConfirm"
							[(ngModel)]="member.passwordConfirm"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
				</div>

				<div class="text-center text-sm">
					คุณมีบัญชีผู้ใช้งานแล้ว ?
					<a routerLink="/login" class="text-[#3500a8] hover:underline">เข้าสู่ระบบ</a>
				</div>

				<button
					type="button"
					(click)="submitMember()"
					class="w-full bg-[#3500a8] text-white py-2 rounded-md font-medium hover:bg-[#280080] transition"
				>
					สมัครสมาชิก
				</button>

			</form>
		</div>

		<!-- ================== ฟอร์มบริษัท ================== -->
		<div *ngIf="mode === 'company'" class="p-8 flex-1">
			<h2 class="text-center text-lg font-semibold mb-6">
				{{ currentStep === 1 ? 'สมัครสมาชิกบริษัท' : 'ข้อมูลเพิ่มเติมของบริษัท' }}
			</h2>

			<!-- STEP 1 ของ บริษัท-->
			<form *ngIf="currentStep === 1" class="space-y-4" (ngSubmit)="$event.preventDefault()">

				<div class="grid grid-cols-2 gap-3">
					<div>
						<label class="block text-sm font-medium mb-1">
							ชื่อผู้สมัคร <span class="text-red-500">*</span>
						</label>
						<input
							type="text"
							name="companyFirstname"
							[(ngModel)]="company.firstname"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
					<div>
						<label class="block text-sm font-medium mb-1">
							นามสกุลผู้สมัคร <span class="text-red-500">*</span>
						</label>
						<input
							type="text"
							name="companyLastname"
							[(ngModel)]="company.lastname"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
				</div>

				<div>
					<label class="block text-sm font-medium mb-1">
						อีเมล <span class="text-red-500">*</span>
					</label>
					<input
						type="email"
						name="companyEmail"
						[(ngModel)]="company.email"
						class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
					/>
				</div>

				<div>
					<label class="block text-sm font-medium mb-1">
						ชื่อบริษัท <span class="text-red-500">*</span>
					</label>
					<input
						type="text"
						name="companyName"
						[(ngModel)]="company.companyName"
						class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
					/>
				</div>

				<div>
					<label class="block text-sm font-medium mb-1">
						เลขประจำตัวผู้เสียภาษี
					</label>
					<input
						type="text"
						name="taxId"
						placeholder="0-0000-00000-00-0"
						[(ngModel)]="company.taxId"
						class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
					/>
				</div>

				<div class="grid grid-cols-2 gap-3">
					<div>
						<label class="block text-sm font-medium mb-1">
							เบอร์โทรติดต่อ <span class="text-red-500">*</span>
						</label>
						<input
							type="tel"
							name="companyPhone"
							[(ngModel)]="company.phone"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
					<div>
						<label class="block text-sm font-kanit mb-1">
							Line ติดต่อบริษัท
						</label>
						<input
							type="text"
							name="companyLine"
							[(ngModel)]="company.line"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
				</div>

				<button
					type="button"
					(click)="nextStep()"
					class="flex items-center justify-center gap-2 w-full bg-blue-800 text-white py-2 rounded-md font-kanit hover:bg-cyan-400 transition"
				>
					ขั่นตอนถัดไป →
				</button>

			</form>

			<!-- STEP 2 -->
			<form *ngIf="currentStep === 2" class="space-y-4" (ngSubmit)="$event.preventDefault()">

				<div class="grid grid-cols-2 gap-3">
					<div>
						<label class="block text-sm font-medium mb-1">
							ธนาคาร <span class="text-red-500">*</span>
						</label>
						<div class="relative">
							<div
								(click)="open = !open"
								class="w-full px-3 py-2 border rounded-md flex justify-between items-center cursor-pointer focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
							>
								<div class="flex items-center gap-2">
									<img *ngIf="selectedBank" [src]="selectedBank.icon" class="w-5 h-5" />
									<span>{{ selectedBank?.name || '-- เลือกธนาคาร --' }}</span>
								</div>
								<span>▼</span>
							</div>
							<ul
								*ngIf="open"
								class="absolute w-full bg-white border rounded-md mt-1 max-h-48 overflow-y-auto z-50"
							>
								<li
									*ngFor="let bank of banks"
									(click)="selectBank(bank)"
									class="px-3 py-2 flex items-center gap-2 cursor-pointer hover:bg-gray-100"
								>
									<img [src]="bank.icon" class="w-5 h-5" />
									<span>{{ bank.name }}</span>
								</li>
							</ul>
						</div>
					</div>

					<div>
						<label class="block text-sm font-kanit mb-1">
							เลขบัญชี <span class="text-red-500">*</span>
						</label>
						<input
							type="text"
							name="bankNumber"
							[(ngModel)]="company.bankNumber"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
				</div>

				<div>
					<label class="block text-sm font-kanit mb-1">
						ชื่อบัญชี <span class="text-red-500">*</span>
					</label>
					<input
						type="text"
						name="bankAccountName"
						[(ngModel)]="company.bankAccountName"
						class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
					/>
				</div>

				<div>
					<label class="block text-sm font-kanit mb-1">
						ที่อยู่บริษัท <span class="text-red-500">*</span>
					</label>
					<textarea
						rows="3"
						name="companyAddress"
						[(ngModel)]="company.companyAddress"
						class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
					></textarea>
				</div>

				<div>
					<label class="block text-sm font-kanit mb-1">
						เอกสารการจดทะเบียนบริษัท <span class="text-red-500">*</span>
					</label>
					<input
						type="file"
						class="w-full text-sm border rounded-md p-2"
						(change)="company.document = $any($event.target).files[0]"
					/>
				</div>

				<div class="grid grid-cols-2 gap-3">
					<div>
						<label class="block text-sm font-kanit mb-1">
							รหัสผ่าน <span class="text-red-500">*</span>
						</label>
						<input
							type="password"
							name="companyPassword"
							[(ngModel)]="company.password"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
					<div>
						<label class="block text-sm font-kanit mb-1">
							ยืนยันรหัสผ่าน <span class="text-red-500">*</span>
						</label>
						<input
							type="password"
							name="companyPasswordConfirm"
							[(ngModel)]="company.passwordConfirm"
							class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#3500a8]"
						/>
					</div>
				</div>

				<div class="flex justify-between">
					<button
						type="button"
						(click)="prevStep()"
						class="bg-gray-300 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-400 transition"
					>
						← กลับ
					</button>
					<button
						type="button"
						(click)="submitCompany()"
						class="bg-[#3500a8] text-white py-2 px-4 rounded-md hover:bg-[#280080] transition"
					>
						สมัครบริษัท
					</button>
				</div>

			</form>
		</div>
	</div>
</div>
